(* ::Package:: *)

(* ::Chapter:: *)
(*Part 1*)


(* ::Input:: *)
(*psVs:={{{152594199160345,147562599184759},{229,220}},{{181402578613976,206158696386036},{179,99}},{{306345582484815,290719456201785},{-19,-64}},{{324804504191222,288308881397108},{-61,-55}},{{205425286498054,395557616674288},{64,-263}},{{372255999352491,192496548823931},{33,-22}},{{360307098368269,492746351958427},{-191,-440}},{{216844619122082,122660781543037},{152,142}},{{176089413220846,342046261904356},{163,-127}},{{350096852708706,346169716907076},{-6,-165}},{{215440993192730,257263538643700},{101,31}},{{299985983558686,109001017518436},{11,204}},{{138662763687895,360460093429666},{149,-7}},{{239261584978334,457675442313716},{-120,-507}},{{207729384910050,397748147029318},{14,-284}},{{305471099417350,176022046801316},{37,63}},{{224279074298386,52691363133212},{13,681}},{{204158452011690,312622336293437},{-136,132}},{{418359651736057,343294961988046},{-35,-167}},{{238163478911224,349086391242094},{37,-148}},{{343512634734597,95747749289964},{-33,195}},{{184506988243064,319979732976203},{42,24}},{{150294357141782,356490587522532},{42,-13}},{{32928575559625,152905355696161},{365,18}},{{387397952558396,223340178183561},{18,-52}},{{196022684467926,345273127238492},{-27,-76}},{{271096256797246,139826436684496},{28,202}},{{151863172680202,235930162855846},{230,58}},{{284720322288394,215166102502296},{-89,168}},{{307433490415500,215720840739340},{11,31}},{{161426577897053,358632250473591},{-63,-52}},{{169916933778548,390340963864469},{110,-274}},{{223167605882521,264980788461256},{93,7}},{{171035386880798,292703502950829},{44,252}},{{190469843776054,230347940993002},{84,245}},{{158220357987023,360812057413265},{21,-96}},{{501582478915186,488334380126056},{-176,-337}},{{225865057924494,277451889912308},{-114,185}},{{186118994624206,297080132928820},{8,159}},{{246747824215369,287361092904898},{25,-19}},{{338580227244686,152672545943876},{45,39}},{{169505720581776,354204106069096},{47,-95}},{{335557789732182,358049225659469},{-76,-174}},{{275411830152174,343943823778565},{-100,-126}},{{257696624671446,308021702856677},{68,-96}},{{265919692055580,486689753352636},{-129,-537}},{{316185883798270,360629781569228},{-116,-174}},{{362816706156392,289314307407256},{-153,-47}},{{213706445531236,226806651458158},{-77,412}},{{250447712214525,172412185591855},{141,16}},{{278950492245354,259981617564784},{-96,79}},{{245074687501777,327436841469802},{27,-103}},{{169529206426774,392657023349500},{-153,-430}},{{293333310546940,295974430848238},{-78,-35}},{{147841642312720,327877200380956},{157,103}},{{136409049116430,252586761071605},{252,202}},{{267933722906914,167726821514947},{-8,216}},{{362919442495237,147228743645266},{31,33}},{{310320440502646,186356104291531},{-28,110}},{{175633288871704,340919448624400},{22,-25}},{{331524952001614,242395952210140},{50,-56}},{{233575593402052,232293139805458},{-26,205}},{{350338918662679,242814642940468},{-85,11}},{{212308130940010,333739166252917},{32,-86}},{{187298136400684,160674890380198},{182,129}},{{210433051915540,258356766064630},{-15,210}},{{333094357827153,488566410848007},{-75,-396}},{{558516164018636,235676828632715},{-162,-60}},{{366028682530046,237089453502106},{12,-50}},{{279233252811527,249486666077029},{-69,82}},{{190325883481246,371536984850842},{-132,-196}},{{250624808575766,351321521448836},{81,-165}},{{288414693406782,340025921259292},{60,-155}},{{414152161864414,258853829139604},{-50,-70}},{{353588055928696,318001619375116},{53,-145}},{{144857817142042,316956441258730},{174,192}},{{173144359981822,206774271899824},{12,820}},{{175335207142786,295933625116780},{103,89}},{{193260017663918,267186122306260},{84,115}},{{207302324998390,52792536129592},{142,334}},{{165728895170686,335693849120836},{88,-7}},{{254777254213866,223031288888019},{128,-28}},{{237180008746252,232843660316332},{-30,195}},{{391925634314950,414056898358252},{10,-239}},{{137584441783870,43623241625308},{252,685}},{{154097338446610,348506463133336},{142,-67}},{{258347162089702,166784594443108},{127,31}},{{159810151947134,301461547194557},{140,122}},{{411044522221952,229456308495058},{-9,-56}},{{334557403100094,270221630608932},{-40,-43}},{{336169188393960,243214850903372},{26,-45}},{{244779508446334,226125745432198},{76,50}},{{281766229425634,207555269438542},{32,61}},{{224890102213918,325055281052020},{-56,-35}},{{264498628335766,410837287571916},{61,-258}},{{191641903033354,21889579009388},{151,485}},{{253765437840730,124205298077170},{40,265}},{{287082250776471,341472776311031},{-15,-142}},{{457089457547761,453755286564385},{-77,-284}},{{346078593487981,428869146383112},{-17,-273}},{{330335416353805,347152582530766},{25,-167}},{{177181404204682,329931224702873},{-104,144}},{{195406155792502,87067516679632},{160,285}},{{216209579908392,372569332696368},{77,-199}},{{149698763784196,387072873735106},{133,-312}},{{305555829251550,313152072958496},{60,-127}},{{272617487081250,234291416315440},{-46,109}},{{268661103092734,282275459744900},{-14,-13}},{{305414032524264,176810786410806},{-111,228}},{{396751568491658,235131801871945},{-64,-26}},{{347118966110096,321422968696606},{-105,-110}},{{311403853794203,397257779924298},{29,-231}},{{294157490407717,447583370454712},{71,-289}},{{269180929961096,415305986610313},{-82,-308}},{{179962301510935,196917988040818},{169,161}},{{183933901657988,363517166633282},{-33,-150}},{{419745585164926,390290972664672},{-212,-228}},{{345624720184246,87817455790156},{23,128}},{{342403742898844,524595656228182},{-38,-419}},{{283915029283591,123783115203106},{53,153}},{{421503435173226,203949834496826},{-88,9}},{{163428506480692,346711461769210},{35,-14}},{{149383612220338,290961746358390},{226,-6}},{{315832192687354,251026257314262},{10,-28}},{{262486390506370,229304631394876},{75,13}},{{266150455590831,37643336681821},{59,322}},{{478567147309190,256334844169236},{-123,-67}},{{210151767389694,339116369148852},{-84,-51}},{{220650844845132,258740420314654},{15,124}},{{232929232832582,304497593052576},{72,-67}},{{225100803509611,311851533614431},{-21,-12}},{{233562823275856,104602380690226},{31,424}},{{282073068230644,252455464020058},{27,-6}},{{207537894228369,255323270230359},{-111,384}},{{191030508108446,357480019866356},{176,-175}},{{165289070787838,383515847531536},{140,-242}},{{183998530406554,394310697552536},{106,-267}},{{217438549681856,286804354827531},{-10,78}},{{126881973004786,27217486043806},{274,238}},{{226968084165271,37722838154106},{103,381}},{{417830070993046,164985998965256},{-146,102}},{{298337792251246,210906428861844},{43,20}},{{225255231081453,355983132676207},{107,-170}},{{412410070879222,405924794471836},{-60,-237}},{{220105099940918,250401088685452},{117,10}},{{260177155808296,262849860444579},{118,-70}},{{425610974047198,182456663714180},{-80,27}},{{152820772841246,340749905912180},{68,95}},{{303988532005533,329845490465880},{-111,-105}},{{501232639798930,139901036609944},{-86,25}},{{242951260153837,288077770801502},{31,-19}},{{347502648637438,383489075238754},{-116,-218}},{{146682021101377,330213387487195},{137,164}},{{143731913097078,131359901889984},{224,677}},{{211213846726234,313919593797832},{-53,36}},{{350511773284718,64697286911144},{32,134}},{{263993979588230,271542360910451},{116,-82}},{{337002670956868,145835842731664},{-83,189}},{{266726671302384,54733722759963},{86,230}},{{207816254074438,323882604187012},{-140,59}},{{172733505019546,391840549258906},{-150,-402}},{{158732519688116,356524213602101},{66,-84}},{{195116880221707,308200067615095},{11,60}},{{300411020214431,313579887529771},{-37,-92}},{{392433752074778,509430470382106},{-16,-347}},{{327296171676166,228720823123756},{-81,58}},{{140969174290245,373749190581731},{155,-222}},{{443491735512655,156148481192214},{-59,29}},{{138522691757704,182753513917027},{242,516}},{{193856952260046,240165397296856},{92,175}},{{264982740290122,368768973116468},{85,-193}},{{163439106785923,282664905365647},{99,276}},{{178889896049332,354535728448848},{31,-111}},{{421204482487708,238174229977900},{-53,-49}},{{481406709675576,159393455073106},{-78,13}},{{411365066171366,192855150652535},{-12,-18}},{{271732807914838,331265125193124},{-245,-49}},{{270218627095246,266358815719060},{-32,31}},{{410437172017222,235226858199610},{-16,-58}},{{318995689521760,204598580627392},{37,9}},{{374598513905778,232760497993333},{-136,34}},{{222905932228736,303860523737516},{15,-9}},{{263976751782166,427499683981996},{-109,-356}},{{263002401509950,208156468216163},{76,42}},{{186577751205476,359654442904566},{99,-160}},{{428147965025476,161280110945578},{-97,62}},{{188349599016781,370553157657346},{-33,-191}},{{184762529603542,234433029340758},{112,206}},{{298320493085068,495329666496408},{55,-355}},{{252495898281444,279259324126134},{30,-15}},{{267027479781992,342434784765360},{-19,-135}},{{245209533224942,305929015398932},{-36,-21}},{{370600643446482,390901375495454},{-18,-220}},{{207224162157826,315907884044596},{62,-45}},{{314008085617456,347267410855941},{-98,-148}},{{205953951080710,330708414731596},{5,-52}},{{220775021659389,292870697849887},{-129,154}},{{360538181345232,226991289899110},{-31,-8}},{{210975809716718,369368681038260},{-109,-186}},{{327360215423448,333340844887008},{-171,-111}},{{195672413082624,450654313636704},{-118,-673}},{{244972718643226,293294731881376},{41,-40}},{{288029511177284,381247517765213},{-10,-214}},{{395036788847933,89523868517282},{-55,149}},{{428979357143276,213600966062416},{-127,13}},{{195087757553710,343934489428180},{-59,-54}},{{249990323775072,503410048575866},{-33,-532}},{{234655641827275,222274252079893},{77,80}},{{165481005413394,339816397288489},{80,-20}},{{388218363336856,161013818643952},{-17,37}},{{165061708393470,296730803122910},{12,377}},{{450065732358964,186179424619410},{-53,-10}},{{162355628406514,352537874840760},{-8,-25}},{{185940470464918,227396836102600},{166,74}},{{334487032463236,255636722153841},{46,-70}},{{155334223788957,408128458614790},{69,-503}},{{300367129543336,293963860346220},{103,-121}},{{218806323623292,299794218312383},{114,-70}},{{282024252473434,89890439538230},{70,174}},{{298748174350666,213896119141672},{-162,209}},{{275252715885622,184333940187245},{-44,210}},{{141839520220054,360131543370892},{86,9}},{{150947999580925,358878345282076},{87,-77}},{{243358245529574,278429369973079},{20,10}},{{351422410027386,292457384634366},{-162,-42}},{{322952184479651,127622781685128},{83,39}},{{386909229876352,110638768841338},{-86,165}},{{261370218124546,219294239958956},{-47,173}},{{145494696702810,180245641010864},{194,825}},{{264790715348386,413750881822146},{-134,-324}},{{214384350673834,68262945647800},{175,144}},{{141961764514954,385928012211850},{86,-448}},{{208125843506770,321236134847746},{-58,18}},{{233886988078086,237843720771156},{-114,303}},{{341381673180991,272178482987221},{-25,-58}},{{343599892421288,528206381694618},{-229,-564}},{{356271829043389,314917591363519},{-195,-80}},{{331211685276898,423426278608888},{-110,-295}},{{209298906696822,336201935868436},{71,-107}},{{224186989009646,178804511599156},{137,76}},{{236866088499418,282093581345242},{46,-8}},{{258868963815944,249405220350480},{114,-49}},{{199851184499404,301993433413432},{-10,87}},{{198676639258948,269192069916338},{94,69}},{{471341609228185,225541365886417},{-83,-46}},{{155625419156702,355100880795132},{132,-103}},{{144729157239544,370011896155552},{174,-185}},{{256560904060585,188818572376825},{61,106}},{{312612122346734,266599199131492},{20,-53}},{{295113552577864,401163774406474},{85,-230}},{{342527968006742,131824895826476},{35,68}},{{182438542619512,311406228540976},{150,-57}},{{170088545912851,338070233296771},{-145,164}},{{218647984265218,314375613086411},{-104,48}},{{284631107946530,137837463631544},{-31,260}},{{187551339858598,262481323426478},{-8,342}},{{438303900920346,222729391264016},{-82,-27}},{{521188702898156,215861527864152},{-187,-15}},{{147959242887091,236029402483513},{213,260}},{{169518304732954,371683716481156},{110,-197}},{{143077218460049,356504127368580},{75,59}},{{200608127837215,370123198461211},{47,-192}},{{197592997499360,302107357415724},{-115,207}},{{161796340644321,364883306386982},{-7,-135}},{{187426007803420,359357405405485},{182,-178}},{{244214455146761,344376781348843},{33,-140}},{{294086544611880,313281079070857},{26,-110}},{{335531797697302,181296500921176},{-64,113}},{{230460664580920,386687221195224},{-35,-243}},{{193140576450205,297209010882331},{-83,228}},{{486507226223702,179603860035582},{-144,26}},{{188852915907541,112419352683949},{123,460}},{{413990383755211,385627279562616},{-137,-217}},{{415682753793494,314217050091996},{-78,-127}},{{384607821770537,361894475711537},{-223,-178}},{{307826160067586,445840866856751},{-48,-330}},{{435931317815062,118575962323324},{-53,70}},{{312294523930162,255128043852436},{-135,63}},{{197706043227676,424308079919056},{-71,-467}},{{333663660642822,86054488868252},{36,131}},{{365947070802882,244689192811280},{6,-55}},{{450415493671508,275950343587538},{-55,-100}},{{535701919354276,159931264795798},{-127,10}},{{272516060812234,146067011336910},{130,24}},{{344297826437918,266079722347836},{-24,-52}},{{296070181415998,278986416202036},{64,-82}},{{184590425268172,56017305708452},{217,107}},{{344981118386806,239611214985676},{58,-67}},{{203104239625346,318025482580212},{-57,47}},{{220997103344778,248842140181896},{-63,258}},{{209111853253102,290836458849028},{61,19}},{{356162421981246,365775053569956},{-36,-189}},{{236252330200406,353673339971172},{-127,-129}},{{257866529074126,58204360480264},{28,399}},{{421824052752380,529811649098538},{-66,-379}},{{248341593005335,253656616281753},{91,-18}},{{274942325037246,313057269065956},{-84,-53}},{{519311150524158,329281444072100},{-244,-141}},{{221416506093698,141728594447982},{72,305}},{{287288280822928,133298621037169},{14,192}}}*)


(* ::Input:: *)
(*(*psVs:={{{19,13},{-2,1}},{{18,19},{-1,-1}},{{20,25},{-2,-2}},{{12,31},{-1,-2}},{{20,19},{1,-5}}};*)*)
(*MakeHalfline[inp_]:=HalfLine[inp[[1]],inp[[2]]];*)


(* ::Input:: *)
(*hlines:=MakeHalfline[#]&/@psVs*)
(*minxy=200000000000000;*)
(*maxxy=400000000000000;*)
(*R=Rectangle[{minxy,minxy},{maxxy,maxxy}]*)


(* ::Input:: *)
(*ans:=0;*)
(*For[i=1,i<=Length[hlines],i++,*)
(*For[j=i+1,j<=Length[hlines],j++,*)
(*hline1:=hlines[[i]];*)
(*hline2:=hlines[[j]];*)
(*sol=NSolve[{x,y}\[Element]hline1\[And]{x,y}\[Element]hline2\[And]{x,y}\[Element]R,{x,y},Reals];*)
(*If[Length[sol]!=0, *)
(*(*Print[{x,y}/.sol];*)
(*Print[Graphics[{{Lighter[Blue,0.5],hline1,hline2},{Red,Point[{x,y}/.sol]},{Opacity[0.2],R}},Axes\[Rule]True,ImageSize\[Rule]Small]];*)*)
(*ans+=1;*)
(*]*)
(*]*)
(*]*)
(*ans*)


(* ::Input:: *)
(*hline1:=HalfLine[{18,19},{-1,-1}]*)
(*hline2:=HalfLine[{20,25},{-2,-2}]*)
(*sol=NSolve[{x,y}\[Element]hline1\[And]{x,y}\[Element]hline2,{x,y},Reals];*)
(*If[Length[sol]!=0, Print[{x,y}/.sol]]*)


(* ::Input:: *)
(**)


(* ::Input:: *)
(*Graphics[{{Lighter[Blue,0.5],hline1,hline2},{Red,Point[{x,y}/.sol]},{Opacity[0.2],R}},Axes->True,ImageSize->Small]*)


(* ::Chapter:: *)
(*Part 2*)


(* ::Input:: *)
(*p0:={152594199160345,147562599184759,291883234654893}*)
(*v0:={229,220,-31}*)
(*p1:={181402578613976,206158696386036,294595238970734}*)
(*v1:={179,99,-32}*)
(*p2:={306345582484815,290719456201785,306246299945991}*)
(*v2:={-19,-64,-43}*)


(* ::Input:: *)
(*rhs:=Join[-Cross[p0,v0]+Cross[p1,v1],-Cross[p0,v0]+Cross[p2,v2]]*)


(* ::Input:: *)
(*rhs*)


(* ::Input:: *)
(*getCrossMatrix[v_]:={{0,-v[[3]],v[[2]]},{v[[3]],0,-v[[1]]},{-v[[2]],v[[1]],0}};*)


(* ::Input:: *)
(*b00:=getCrossMatrix[v0]-getCrossMatrix[v1]*)
(*b30:=getCrossMatrix[v0]-getCrossMatrix[v2]*)
(*b03:=-getCrossMatrix[p0]+getCrossMatrix[p1]*)
(*b33:=-getCrossMatrix[p0]+getCrossMatrix[p2]*)


(* ::Input:: *)
(*M:=Join[Join[b00,b03,2],Join[b30,b33,2]]*)


(* ::Input:: *)
(*M//MatrixForm*)


(* ::Input:: *)
(*LinearSolve[M,rhs]*)


(* ::Input:: *)
(*Total[{131633231355646,371683716481156,238674624073734}]*)
